#include "level.h"
#include "primitive_models.h"
#include "sprites.h"

// walls
//  _  0x12
//
// |_  0x16
//
//  _| 0x1a
//
// |_| 0x1e
//
// |   0x14
//
//   | 0x18
//
// | | 0x1c

static const uint8_t level1_data[] = {
//  -16  -14  -12  -10   -8   -6   -4   -2    0    2    4    6    8   10   12   14   16
	0x14,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x18, // 16
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 14
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 12
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 10
	0x14,0x12,0x12,0x1a,0x01,0x01,0x16,0x12,0x12,0x12,0x1a,0x01,0x01,0x16,0x12,0x12,0x18, // 8
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 6
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 4
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 2
	0x1c,0x01,0x01,0x16,0x12,0x12,0x1a,0x01,0x01,0x01,0x16,0x12,0x12,0x1a,0x01,0x01,0x1c, // 0
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -2
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -4
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -6
	0x14,0x12,0x12,0x1a,0x01,0x01,0x16,0x12,0x12,0x12,0x1a,0x01,0x01,0x16,0x12,0x12,0x18, // -8
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -10
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -12
	0x1e,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1e, // -14
	0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20, // -16
};

static const path_node_t level1_path_nodes[] = {
	{-1, {-12.f,  20.f}}, // 0
	{-1, { -4.f,  20.f}}, // 1
	{-1, {  4.f,  20.f}}, // 2
	{-1, { 12.f,  20.f}}, // 3

	{ 0, {-12.f,  14.f}}, // 4
	{ 1, { -4.f,  14.f}}, // 5
	{ 2, {  4.f,  14.f}}, // 6
	{ 3, { 12.f,  14.f}}, // 7

	{ 5, { -7.f,  10.f}}, // 8
	{ 6, {  7.f,  10.f}}, // 9

	{ 8, { -7.f,   6.f}}, // 10
	{ 9, {  7.f,   6.f}}, // 11

	{10, {-13.f,   2.f}}, // 12
	{10, {  0.f,   2.f}}, // 13
	{11, { 13.f,   2.f}}, // 14

	{12, {-13.f,  -2.f}}, // 15
	{13, {  0.f,  -2.f}}, // 16
	{14, { 13.f,  -2.f}}, // 17

	{16, { -7.f,  -6.f}}, // 18
	{16, {  7.f,  -6.f}}, // 19

	{18, { -7.f, -10.f}}, // 20
	{19, {  7.f, -10.f}}, // 21

	{20, {-13.f,  -14.f}}, // 22
	{20, {  0.f,  -14.f}}, // 23
	{21, { 13.f,  -14.f}}, // 24

	{22, {-13.f,  -16.f}}, // 25
	{23, {  0.f,  -16.f}}, // 26
	{24, { 13.f,  -16.f}}, // 27
};

static const path_edge_t level1_path_edges[] = {
	{0, 4},
	{1, 5},
	{2, 6},
	{3, 7},
	
	{4, 8},
	{5, 8},
	{4, 9},
	{5, 9},
	{6, 8},
	{7, 8},
	{6, 9},
	{7, 9},

	{8, 10},
	{9, 11},

	{10, 12},
	{10, 13},
	{10, 14},
	{11, 12},
	{11, 13},
	{11, 14},

	{12, 15},
	{13, 16},
	{14, 17},

	{15, 18},
	{15, 19},
	{16, 18},
	{16, 19},
	{17, 18},
	{17, 19},

	{18, 20},
	{19, 21},

	{20, 22},
	{20, 23},
	{20, 24},
	{21, 22},
	{21, 23},
	{21, 24},

	{22, 25},
	{23, 26},
	{24, 27},
};

static const path_graph_t level1_graph = MAKE_PATH_GRAPH(level1_path_nodes, level1_path_edges);

static const level_light_t level1_lights[] = {
	{{-12.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ -4.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{  4.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ 12.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
};

static const level_t level1 = {
	17, 17, // size
	15, 3,  // target
	60, 120, // spawn duration
	&level1_graph,
	level1_data,
	ARRAY_LENGTH(level1_lights),
	level1_lights,
	"Level 1",
};

// LEVEL 2

// walls
//  _  0x12
//
// |_  0x16
//
//  _| 0x1a
//
// |_| 0x1e
//
// |   0x14
//
//   | 0x18
//
// | | 0x1c

static const uint8_t level2_data[] = {
//  -16  -14  -12  -10   -8   -6   -4   -2    0    2    4    6    8   10   12   14   16
	0x14,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x18, // 16
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 14
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 12
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 10
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 8
	0x14,0x12,0x1a,0x01,0x16,0x18,0x01,0x16,0x12,0x1a,0x01,0x14,0x1a,0x01,0x16,0x12,0x18, // 6
	0x1c,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x1c, // 4
	0x1c,0x01,0x01,0x01,0x01,0x1e,0x01,0x01,0x01,0x01,0x01,0x1e,0x01,0x01,0x01,0x01,0x1c, // 2
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 0
	0x1c,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x01,0x1c,0x01,0x01,0x01,0x01,0x1c, // -2
	0x1c,0x01,0x01,0x01,0x01,0x14,0x12,0x1a,0x01,0x16,0x12,0x18,0x01,0x01,0x01,0x01,0x1c, // -4
	0x1c,0x01,0x16,0x12,0x12,0x1a,0x01,0x01,0x01,0x01,0x01,0x16,0x12,0x12,0x1a,0x01,0x1c, // -6
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -8
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -10
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -12
	0x1e,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1e, // -14
	0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20, // -16
};

static const path_node_t level2_path_nodes[] = {
	{-1, {-12.f,  20.f}}, // 0
	{-1, { -4.f,  20.f}}, // 1
	{-1, {  4.f,  20.f}}, // 2
	{-1, { 12.f,  20.f}}, // 3

	{ 0, {-12.f,  14.f}}, // 4
	{ 1, { -4.f,  14.f}}, // 5
	{ 2, {  4.f,  14.f}}, // 6
	{ 3, { 12.f,  14.f}}, // 7

	{ 4, {-10.f,   8.f}}, // 8
	{ 5, { -4.f,   8.f}}, // 9
	{ 6, {  4.f,   8.f}}, // 10
	{ 7, { 10.f,   8.f}}, // 11

	{ 8, {-10.f,   4.f}}, // 12
	{ 9, { -4.f,   4.f}}, // 13
	{10, {  4.f,   4.f}}, // 14
	{11, { 10.f,   4.f}}, // 15

	{12, {-14.f,  -4.f}}, // 16
	{13, {  0.f,  -2.f}}, // 17
	{15, { 14.f,  -4.f}}, // 18

	{16, {-14.f,  -8.f}}, // 19
	{17, {  0.f,  -7.f}}, // 20
	{18, { 14.f,  -8.f}}, // 21

	{19, {-14.f,  -14.f}}, // 22
	{20, { -6.f,  -14.f}}, // 23
	{20, {  0.f,  -14.f}}, // 24
	{20, {  6.f,  -14.f}}, // 25
	{21, { 14.f,  -14.f}}, // 26

	{22, {-14.f,  -16.f}}, // 27
	{23, { -6.f,  -16.f}}, // 28
	{24, {  0.f,  -16.f}}, // 29
	{25, {  6.f,  -16.f}}, // 30
	{26, { 14.f,  -16.f}}, // 31

	{ 6, { -2.f,   14.f}}, // 32
	{ 5, {  2.f,   14.f}}, // 33

	{ 4, {-14.f,   10.f}}, // 34
	{ 7, { 14.f,   10.f}}, // 35

	{12, { -8.f,    0.f}}, // 36
	{36, { -3.f,    0.f}}, // 37
	{15, {  8.f,    0.f}}, // 38
	{38, {  3.f,    0.f}}, // 39

	{12, {-13.f,    2.f}}, // 40
	{15, { 13.f,    2.f}}, // 41

	{12, { -9.f,   -2.f}}, // 42
	{15, {  9.f,   -2.f}}, // 43

	{13, { -4.f,    0.f}}, // 44
	{44, { -9.f,    0.f}}, // 45
	{14, {  4.f,    0.f}}, // 46
	{46, {  9.f,    0.f}}, // 47

	{ 5, { -2.f,   10.f}}, // 48
	{ 6, {  2.f,   10.f}}, // 49

	{13, { -1.f,    3.f}}, // 50
	{14, {  1.f,    3.f}}, // 51
};

static const path_edge_t level2_path_edges[] = {
	{0, 4},
	{1, 5},
	{2, 6},
	{3, 7},

	{4, 9},
	{4, 34},
	{5, 8},
	{5, 33},
	{5, 48},
	{6, 11},
	{6, 49},
	{6, 32},
	{7, 10},
	{7, 35},

	{8, 12},
	{9, 13},
	{10, 14},
	{11, 15},

	{12, 36},
	{12, 40},
	{12, 42},
	{13, 44},
	{13, 50},
	{14, 46},
	{14, 51},
	{15, 38},
	{15, 41},
	{15, 43},

	{16, 19},
	{17, 20},
	{18, 21},

	{19, 24},
	{19, 23},
	{20, 22},
	{20, 23},
	{20, 25},
	{20, 26},
	{21, 24},
	{21, 25},

	{22, 27},
	{23, 28},
	{24, 29},
	{25, 30},
	{26, 31},

	{32, 8},
	{32, 9},
	{33, 10},
	{33, 11},

	{34, 8},
	{35, 11},

	{36, 37},
	{37, 17},

	{38, 39},
	{39, 17},

	{40, 16},
	{41, 18},
	{42, 16},
	{43, 18},

	{44, 45},
	{45, 16},
	{46, 47},
	{47, 18},

	{48, 9},
	{49, 10},

	{50, 17},
	{51, 17},
};

static const path_graph_t level2_graph = MAKE_PATH_GRAPH(level2_path_nodes, level2_path_edges);

static const level_light_t level2_lights[] = {
	{{-12.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ -4.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{  4.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ 12.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ 0.f,  1.f}, 5.f, LIGHT_TYPE_BLINK},
	{{ -8.f,  12.f}, 6.f, LIGHT_TYPE_BLINK},
	{{ 8.f,  12.f}, 6.f, LIGHT_TYPE_BLINK},
	{{ -11.f,  0.f}, 5.f, LIGHT_TYPE_BLINK},
	{{ 11.f,  0.f}, 5.f, LIGHT_TYPE_BLINK},
	{{ 0.f,  -10.f}, 5.f, LIGHT_TYPE_BLINK},
	{{ -10.f,  -10.f}, 5.f, LIGHT_TYPE_BLINK},
	{{ 10.f,  -10.f}, 5.f, LIGHT_TYPE_BLINK},
};

static const level_t level2 = {
	17, 17, // size
	25, 3,  // target
	60, 120, // spawn duration
	&level2_graph,
	level2_data,
	ARRAY_LENGTH(level2_lights),
	level2_lights,
	"Level 2",
};

// LEVEL 3

// walls
//  _  0x12
//
// |_  0x16
//
//  _| 0x1a
//
// |_| 0x1e
//
// |   0x14
//
//   | 0x18
//
// | | 0x1c

static const uint8_t level3_data[] = {
//  -16  -14  -12  -10   -8   -6   -4   -2    0    2    4    6    8   10   12   14   16
	0x14,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x12,0x1a,0x01,0x16,0x18, // 16
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 14
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 12
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 10
	0x1c,0x01,0x01,0x16,0x1a,0x01,0x01,0x16,0x12,0x1a,0x01,0x01,0x16,0x1a,0x01,0x01,0x1c, // 8
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 6
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 4
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // 2
	0x1c,0x01,0x01,0x16,0x1a,0x01,0x01,0x16,0x12,0x1a,0x01,0x01,0x16,0x1a,0x01,0x01,0x1c, // 0
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -2
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -4
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -6
	0x1c,0x01,0x01,0x16,0x1a,0x01,0x01,0x16,0x12,0x1a,0x01,0x01,0x16,0x1a,0x01,0x01,0x1c, // -8
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -10
	0x1c,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1c, // -12
	0x1e,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x1e, // -14
	0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20,0x20, // -16
};

static const path_node_t level3_path_nodes[] = {
	{-1, {-12.f,  20.f}}, // 0
	{-1, { -4.f,  20.f}}, // 1
	{-1, {  4.f,  20.f}}, // 2
	{-1, { 12.f,  20.f}}, // 3

	{ 0, {-12.f,  14.f}}, // 4
	{ 1, { -4.f,  14.f}}, // 5
	{ 2, {  4.f,  14.f}}, // 6
	{ 3, { 12.f,  14.f}}, // 7

	{ 4, {-13.f,  10.f}}, // 8
	{ 5, { -5.f,  10.f}}, // 9
	{ 6, {  5.f,  10.f}}, // 10
	{ 7, { 13.f,  10.f}}, // 11

	{ 8, {-13.f,   6.f}}, // 12
	{ 9, { -5.f,   6.f}}, // 13
	{10, {  5.f,   6.f}}, // 14
	{11, { 13.f,   6.f}}, // 15

	{12, {-13.f,   2.f}}, // 16
	{13, { -5.f,   2.f}}, // 17
	{14, {  5.f,   2.f}}, // 18
	{15, { 13.f,   2.f}}, // 19

	{16, {-13.f,  -2.f}}, // 20
	{17, { -5.f,  -2.f}}, // 21
	{18, {  5.f,  -2.f}}, // 22
	{19, { 13.f,  -2.f}}, // 23

	{20, {-13.f,  -6.f}}, // 24
	{21, { -5.f,  -6.f}}, // 25
	{22, {  5.f,  -6.f}}, // 26
	{23, { 13.f,  -6.f}}, // 27

	{24, {-13.f, -10.f}}, // 28
	{25, { -5.f, -10.f}}, // 29
	{26, {  5.f, -10.f}}, // 30
	{27, { 13.f, -10.f}}, // 31

	{28, {-13.f, -14.f}}, // 32
	{29, { -5.f, -14.f}}, // 33
	{30, {  5.f, -14.f}}, // 34
	{31, { 13.f, -14.f}}, // 35

	{32, {-13.f, -16.f}}, // 36
	{33, { -5.f, -16.f}}, // 37
	{34, {  5.f, -16.f}}, // 38
	{35, { 13.f, -16.f}}, // 39
};

static const path_edge_t level3_path_edges[] = {
	{0, 4},
	{1, 5},
	{2, 6},
	{3, 7},

	{4, 9},
	{4, 10},
	{4, 11},
	{5, 8},
	{5, 10},
	{5, 11},
	{6, 8},
	{6, 9},
	{6, 11},
	{7, 8},
	{7, 9},
	{7, 10},

	{8, 12},
	{9, 13},
	{10, 14},
	{11, 15},

	{12, 17},
	{12, 18},
	{12, 19},
	{13, 16},
	{13, 18},
	{13, 19},
	{14, 16},
	{14, 17},
	{14, 19},
	{15, 16},
	{15, 17},
	{15, 18},

	{16, 20},
	{17, 21},
	{18, 22},
	{19, 23},

	{20, 25},
	{20, 26},
	{20, 27},
	{21, 24},
	{21, 26},
	{21, 27},
	{22, 24},
	{22, 25},
	{22, 27},
	{23, 24},
	{23, 25},
	{23, 26},

	{24, 28},
	{25, 29},
	{26, 30},
	{27, 31},

	{28, 33},
	{28, 34},
	{28, 35},
	{29, 32},
	{29, 34},
	{29, 35},
	{30, 32},
	{30, 33},
	{30, 35},
	{31, 32},
	{31, 33},
	{31, 34},

	{32, 36},
	{33, 37},
	{34, 38},
	{35, 39},
};

static const path_graph_t level3_graph = MAKE_PATH_GRAPH(level3_path_nodes, level3_path_edges);

static const level_light_t level3_lights[] = {
	{{-12.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ -4.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{  4.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},
	{{ 12.f,  16.f}, 4.f, LIGHT_TYPE_STATIC},

	{{-12.f,  12.f}, 4.f, LIGHT_TYPE_HMOVE},
	{{ -4.f,   4.f}, 4.f, LIGHT_TYPE_HMOVE},
	{{  4.f,  -4.f}, 4.f, LIGHT_TYPE_HMOVE},
	{{ 12.f, -12.f}, 4.f, LIGHT_TYPE_HMOVE},
};

static const level_t level3 = {
	17, 17, // size
	40, 3,  // target
	60, 90, // spawn duration
	&level3_graph,
	level3_data,
	ARRAY_LENGTH(level3_lights),
	level3_lights,
	"Level 3",
};


static const level_t *levels_array[] = {
	&level1,
	&level2,
	&level3,
	NULL,
};

const level_t **levels = levels_array;